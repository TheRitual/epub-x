import type { BuiltInThemeId } from "./types.js";
import type { CliTheme } from "./types.js";
import {
  FRAME_STYLE_SINGLE,
  FRAME_STYLE_DOUBLE,
  FRAME_STYLE_MINIMAL,
  FRAME_STYLE_THICK,
} from "./frame-styles.js";

const r = "\x1b[0m";
const b = "\x1b[1m";
const d = "\x1b[2m";

function theme(
  name: string,
  frame: CliTheme["frameStyle"],
  colors: CliTheme["colors"]
): CliTheme {
  return { name, frameStyle: frame, colors };
}

export const DEFAULT_THEMES: Record<BuiltInThemeId, CliTheme> = {
  default: theme("Default", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[35m",
    section: "\x1b[34m",
    sectionBold: "\x1b[34m\x1b[1m",
    selected: "\x1b[95m",
    selectedBg: "\x1b[45m",
    selectedRowText: "\x1b[97m\x1b[1m",
    unselectedItem: r,
    hintKey: "\x1b[38;5;208m",
    hintDescription: "\x1b[37m",
    hint: "\x1b[2m\x1b[36m",
    valueYes: "\x1b[32m",
    valueNo: "\x1b[31m",
    valueOther: "\x1b[33m",
    accent: "\x1b[35m",
  }),

  "solarized-dark": theme("Solarized Dark", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[33m",
    section: "\x1b[34m",
    sectionBold: "\x1b[34m\x1b[1m",
    selected: "\x1b[35m",
    selectedBg: "\x1b[36m",
    selectedRowText: "\x1b[37m\x1b[1m",
    unselectedItem: "\x1b[37m",
    hintKey: "\x1b[36m",
    hintDescription: "\x1b[33m",
    hint: "\x1b[2m\x1b[34m",
    valueYes: "\x1b[32m",
    valueNo: "\x1b[31m",
    valueOther: "\x1b[33m",
    accent: "\x1b[36m",
  }),

  "solarized-light": theme("Solarized Light", FRAME_STYLE_MINIMAL, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[34m",
    section: "\x1b[33m",
    sectionBold: "\x1b[33m\x1b[1m",
    selected: "\x1b[35m",
    selectedBg: "\x1b[36m",
    selectedRowText: "\x1b[30m\x1b[1m",
    unselectedItem: "\x1b[30m",
    hintKey: "\x1b[36m",
    hintDescription: "\x1b[34m",
    hint: "\x1b[2m\x1b[33m",
    valueYes: "\x1b[32m",
    valueNo: "\x1b[31m",
    valueOther: "\x1b[33m",
    accent: "\x1b[36m",
  }),

  monokai: theme("Monokai", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[35m",
    section: "\x1b[36m",
    sectionBold: "\x1b[36m\x1b[1m",
    selected: "\x1b[95m",
    selectedBg: "\x1b[38;5;53m",
    selectedRowText: "\x1b[97m\x1b[1m",
    unselectedItem: "\x1b[37m",
    hintKey: "\x1b[33m",
    hintDescription: "\x1b[90m",
    hint: "\x1b[2m\x1b[35m",
    valueYes: "\x1b[32m",
    valueNo: "\x1b[31m",
    valueOther: "\x1b[33m",
    accent: "\x1b[36m",
  }),

  nord: theme("Nord", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;109m",
    section: "\x1b[38;5;104m",
    sectionBold: "\x1b[38;5;104m\x1b[1m",
    selected: "\x1b[38;5;212m",
    selectedBg: "\x1b[38;5;61m",
    selectedRowText: "\x1b[38;5;224m\x1b[1m",
    unselectedItem: "\x1b[38;5;224m",
    hintKey: "\x1b[38;5;109m",
    hintDescription: "\x1b[38;5;224m",
    hint: "\x1b[2m\x1b[38;5;104m",
    valueYes: "\x1b[38;5;114m",
    valueNo: "\x1b[38;5;210m",
    valueOther: "\x1b[38;5;180m",
    accent: "\x1b[38;5;104m",
  }),

  dracula: theme("Dracula", FRAME_STYLE_DOUBLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[35m",
    section: "\x1b[36m",
    sectionBold: "\x1b[36m\x1b[1m",
    selected: "\x1b[95m",
    selectedBg: "\x1b[38;5;54m",
    selectedRowText: "\x1b[97m\x1b[1m",
    unselectedItem: "\x1b[37m",
    hintKey: "\x1b[33m",
    hintDescription: "\x1b[38;5;255m",
    hint: "\x1b[2m\x1b[35m",
    valueYes: "\x1b[32m",
    valueNo: "\x1b[31m",
    valueOther: "\x1b[33m",
    accent: "\x1b[36m",
  }),

  "one-dark": theme("One Dark", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;209m",
    section: "\x1b[38;5;114m",
    sectionBold: "\x1b[38;5;114m\x1b[1m",
    selected: "\x1b[38;5;212m",
    selectedBg: "\x1b[38;5;62m",
    selectedRowText: "\x1b[38;5;230m\x1b[1m",
    unselectedItem: "\x1b[38;5;230m",
    hintKey: "\x1b[38;5;229m",
    hintDescription: "\x1b[38;5;246m",
    hint: "\x1b[2m\x1b[38;5;109m",
    valueYes: "\x1b[38;5;114m",
    valueNo: "\x1b[38;5;210m",
    valueOther: "\x1b[38;5;180m",
    accent: "\x1b[38;5;209m",
  }),

  "gruvbox-dark": theme("Gruvbox Dark", FRAME_STYLE_THICK, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;208m",
    section: "\x1b[38;5;109m",
    sectionBold: "\x1b[38;5;109m\x1b[1m",
    selected: "\x1b[38;5;214m",
    selectedBg: "\x1b[38;5;136m",
    selectedRowText: "\x1b[38;5;230m\x1b[1m",
    unselectedItem: "\x1b[38;5;223m",
    hintKey: "\x1b[38;5;108m",
    hintDescription: "\x1b[38;5;246m",
    hint: "\x1b[2m\x1b[38;5;109m",
    valueYes: "\x1b[38;5;106m",
    valueNo: "\x1b[38;5;167m",
    valueOther: "\x1b[38;5;208m",
    accent: "\x1b[38;5;109m",
  }),

  "gruvbox-light": theme("Gruvbox Light", FRAME_STYLE_MINIMAL, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;94m",
    section: "\x1b[38;5;66m",
    sectionBold: "\x1b[38;5;66m\x1b[1m",
    selected: "\x1b[38;5;130m",
    selectedBg: "\x1b[38;5;143m",
    selectedRowText: "\x1b[38;5;235m\x1b[1m",
    unselectedItem: "\x1b[38;5;237m",
    hintKey: "\x1b[38;5;24m",
    hintDescription: "\x1b[38;5;101m",
    hint: "\x1b[2m\x1b[38;5;66m",
    valueYes: "\x1b[38;5;28m",
    valueNo: "\x1b[38;5;88m",
    valueOther: "\x1b[38;5;94m",
    accent: "\x1b[38;5;66m",
  }),

  "catppuccin-mocha": theme("Catppuccin Mocha", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;183m",
    section: "\x1b[38;5;137m",
    sectionBold: "\x1b[38;5;137m\x1b[1m",
    selected: "\x1b[38;5;212m",
    selectedBg: "\x1b[38;5;60m",
    selectedRowText: "\x1b[38;5;230m\x1b[1m",
    unselectedItem: "\x1b[38;5;248m",
    hintKey: "\x1b[38;5;179m",
    hintDescription: "\x1b[38;5;245m",
    hint: "\x1b[2m\x1b[38;5;139m",
    valueYes: "\x1b[38;5;114m",
    valueNo: "\x1b[38;5;131m",
    valueOther: "\x1b[38;5;179m",
    accent: "\x1b[38;5;137m",
  }),

  "catppuccin-latte": theme("Catppuccin Latte", FRAME_STYLE_MINIMAL, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;60m",
    section: "\x1b[38;5;62m",
    sectionBold: "\x1b[38;5;62m\x1b[1m",
    selected: "\x1b[38;5;168m",
    selectedBg: "\x1b[38;5;183m",
    selectedRowText: "\x1b[38;5;30m\x1b[1m",
    unselectedItem: "\x1b[38;5;59m",
    hintKey: "\x1b[38;5;136m",
    hintDescription: "\x1b[38;5;101m",
    hint: "\x1b[2m\x1b[38;5;62m",
    valueYes: "\x1b[38;5;29m",
    valueNo: "\x1b[38;5;124m",
    valueOther: "\x1b[38;5;94m",
    accent: "\x1b[38;5;62m",
  }),

  "tokyo-night": theme("Tokyo Night", FRAME_STYLE_DOUBLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;99m",
    section: "\x1b[38;5;74m",
    sectionBold: "\x1b[38;5;74m\x1b[1m",
    selected: "\x1b[38;5;212m",
    selectedBg: "\x1b[38;5;60m",
    selectedRowText: "\x1b[38;5;252m\x1b[1m",
    unselectedItem: "\x1b[38;5;252m",
    hintKey: "\x1b[38;5;117m",
    hintDescription: "\x1b[38;5;246m",
    hint: "\x1b[2m\x1b[38;5;99m",
    valueYes: "\x1b[38;5;150m",
    valueNo: "\x1b[38;5;210m",
    valueOther: "\x1b[38;5;179m",
    accent: "\x1b[38;5;74m",
  }),

  "everforest-dark": theme("Everforest Dark", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;109m",
    section: "\x1b[38;5;108m",
    sectionBold: "\x1b[38;5;108m\x1b[1m",
    selected: "\x1b[38;5;223m",
    selectedBg: "\x1b[38;5;108m",
    selectedRowText: "\x1b[38;5;223m\x1b[1m",
    unselectedItem: "\x1b[38;5;223m",
    hintKey: "\x1b[38;5;143m",
    hintDescription: "\x1b[38;5;109m",
    hint: "\x1b[2m\x1b[38;5;108m",
    valueYes: "\x1b[38;5;108m",
    valueNo: "\x1b[38;5;167m",
    valueOther: "\x1b[38;5;208m",
    accent: "\x1b[38;5;108m",
  }),

  "everforest-light": theme("Everforest Light", FRAME_STYLE_MINIMAL, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;66m",
    section: "\x1b[38;5;72m",
    sectionBold: "\x1b[38;5;72m\x1b[1m",
    selected: "\x1b[38;5;100m",
    selectedBg: "\x1b[38;5;108m",
    selectedRowText: "\x1b[38;5;235m\x1b[1m",
    unselectedItem: "\x1b[38;5;237m",
    hintKey: "\x1b[38;5;65m",
    hintDescription: "\x1b[38;5;66m",
    hint: "\x1b[2m\x1b[38;5;72m",
    valueYes: "\x1b[38;5;72m",
    valueNo: "\x1b[38;5;131m",
    valueOther: "\x1b[38;5;94m",
    accent: "\x1b[38;5;72m",
  }),

  "rose-pine": theme("Ros√© Pine", FRAME_STYLE_SINGLE, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;176m",
    section: "\x1b[38;5;24m",
    sectionBold: "\x1b[38;5;24m\x1b[1m",
    selected: "\x1b[38;5;212m",
    selectedBg: "\x1b[38;5;60m",
    selectedRowText: "\x1b[38;5;224m\x1b[1m",
    unselectedItem: "\x1b[38;5;224m",
    hintKey: "\x1b[38;5;215m",
    hintDescription: "\x1b[38;5;246m",
    hint: "\x1b[2m\x1b[38;5;24m",
    valueYes: "\x1b[38;5;114m",
    valueNo: "\x1b[38;5;210m",
    valueOther: "\x1b[38;5;179m",
    accent: "\x1b[38;5;24m",
  }),

  kanagawa: theme("Kanagawa", FRAME_STYLE_THICK, {
    reset: r,
    bold: b,
    dim: d,
    message: "\x1b[38;5;180m",
    section: "\x1b[38;5;109m",
    sectionBold: "\x1b[38;5;109m\x1b[1m",
    selected: "\x1b[38;5;181m",
    selectedBg: "\x1b[38;5;59m",
    selectedRowText: "\x1b[38;5;230m\x1b[1m",
    unselectedItem: "\x1b[38;5;223m",
    hintKey: "\x1b[38;5;109m",
    hintDescription: "\x1b[38;5;246m",
    hint: "\x1b[2m\x1b[38;5;66m",
    valueYes: "\x1b[38;5;109m",
    valueNo: "\x1b[38;5;167m",
    valueOther: "\x1b[38;5;180m",
    accent: "\x1b[38;5;109m",
  }),
};

export function getDefaultTheme(id: BuiltInThemeId): CliTheme {
  const t = DEFAULT_THEMES[id];
  if (!t) return DEFAULT_THEMES.default;
  return {
    name: t.name,
    frameStyle: { ...t.frameStyle },
    colors: { ...t.colors },
  };
}

export function getBuiltInThemeIds(): BuiltInThemeId[] {
  return Object.keys(DEFAULT_THEMES) as BuiltInThemeId[];
}
